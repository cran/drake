<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Get the code.</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p><img src="https://ropensci.github.io/drake/images/infographic.svg" alt="infographic" align="center" style = "border: none; float: center;"></p>

<p>This tutorial is a recommended starting place for learning how to use <code>drake</code>. It is the abridged version of the <a href="https://github.com/ropensci/drake/blob/master/vignettes/example-basic.Rmd">basic example vignette</a>. See <a href="https://github.com/ropensci/drake/blob/master/README.md#documentation">this section of the README</a> for a high-level overview of the available documentation.</p>

<h1>Get the code.</h1>

<p>Write the code files to your workspace.</p>

<pre><code class="r">drake_example(&quot;basic&quot;)
</code></pre>

<p>The new <code>basic</code> folder now includes a file structure of a serious <code>drake</code> project, plus an <code>interactive-tutorial.R</code> to narrate the example. The code is also <a href="https://github.com/ropensci/drake/tree/master/inst/examples/basic">online here</a>.</p>

<h1>The motivation of the basic example</h1>

<p>Is there an association between the weight and the fuel efficiency of cars? To find out, we use the <code>mtcars</code> dataset from the <code>datasets</code> package. The <code>mtcars</code> dataset originally came from the 1974 Motor Trend US magazine, and it contains design and performance data on 32 models of automobile.</p>

<pre><code class="r"># ?mtcars # more info
head(mtcars)
##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
</code></pre>

<p>Here, <code>wt</code> is weight in tons, and <code>mpg</code> is fuel efficiency in miles per gallon. We want to figure out if there is an association between <code>wt</code> and <code>mpg</code>. The <code>mtcars</code> dataset itself only has 32 rows, so we generate two larger bootstrapped datasets and then analyze them with regression models. We summarize the regression models to see if there is an association.</p>

<h1>A taste of the basic example</h1>

<p>Your workspace begins with a bunch of imports: functions, pre-loaded data objects, and saved files available before the real work begins.</p>

<pre><code class="r">load_basic_example(verbose = FALSE) # Get the code with drake_example(&quot;basic&quot;).

# Drake looks for data objects and functions in your R session environment
ls()
##  [1] &quot;AES&quot;               &quot;AESdecryptECB&quot;     &quot;AESencryptECB&quot;    
##  [4] &quot;AESinit&quot;           &quot;attr_sha1&quot;         &quot;avoid_this&quot;       
##  [7] &quot;b&quot;                 &quot;bad_plan&quot;          &quot;cache&quot;            
## [10] &quot;command&quot;           &quot;config&quot;            &quot;cranlogs_plan&quot;    
## [13] &quot;debug_plan&quot;        &quot;digest&quot;            &quot;digest_impl&quot;      
## [16] &quot;envir&quot;             &quot;error&quot;             &quot;f&quot;                
## [19] &quot;g&quot;                 &quot;get_logs&quot;          &quot;good_plan&quot;        
## [22] &quot;hard_plan&quot;         &quot;hmac&quot;              &quot;little_b&quot;         
## [25] &quot;logs&quot;              &quot;makeRaw&quot;           &quot;makeRaw.character&quot;
## [28] &quot;makeRaw.default&quot;   &quot;makeRaw.digest&quot;    &quot;makeRaw.raw&quot;      
## [31] &quot;modes&quot;             &quot;my_plan&quot;           &quot;my_variable&quot;      
## [34] &quot;myplan&quot;            &quot;new_objects&quot;       &quot;num2hex&quot;          
## [37] &quot;padWithZeros&quot;      &quot;plan&quot;              &quot;print.AES&quot;        
## [40] &quot;query&quot;             &quot;random_rows&quot;       &quot;reg1&quot;             
## [43] &quot;reg2&quot;              &quot;rules_grid&quot;        &quot;sha1&quot;             
## [46] &quot;sha1.Date&quot;         &quot;sha1.NULL&quot;         &quot;sha1.POSIXct&quot;     
## [49] &quot;sha1.POSIXlt&quot;      &quot;sha1.anova&quot;        &quot;sha1.array&quot;       
## [52] &quot;sha1.call&quot;         &quot;sha1.character&quot;    &quot;sha1.complex&quot;     
## [55] &quot;sha1.data.frame&quot;   &quot;sha1.default&quot;      &quot;sha1.factor&quot;      
## [58] &quot;sha1.function&quot;     &quot;sha1.integer&quot;      &quot;sha1.list&quot;        
## [61] &quot;sha1.logical&quot;      &quot;sha1.matrix&quot;       &quot;sha1.name&quot;        
## [64] &quot;sha1.numeric&quot;      &quot;sha1.pairlist&quot;     &quot;sha1.raw&quot;         
## [67] &quot;simulate&quot;          &quot;timestamp&quot;         &quot;tmp&quot;              
## [70] &quot;totally_okay&quot;      &quot;url&quot;               &quot;x&quot;

# and saved files in your file system.
list.files()
##  [1] &quot;best-practices.R&quot;     &quot;best-practices.Rmd&quot;   &quot;best-practices.html&quot; 
##  [4] &quot;best-practices.md&quot;    &quot;caution.R&quot;            &quot;caution.Rmd&quot;         
##  [7] &quot;caution.html&quot;         &quot;caution.md&quot;           &quot;debug.R&quot;             
## [10] &quot;debug.Rmd&quot;            &quot;debug.html&quot;           &quot;debug.md&quot;            
## [13] &quot;drake.R&quot;              &quot;drake.Rmd&quot;            &quot;example-basic.Rmd&quot;   
## [16] &quot;example-gsp.Rmd&quot;      &quot;example-packages.Rmd&quot; &quot;faq.Rmd&quot;             
## [19] &quot;figure&quot;               &quot;graph.Rmd&quot;            &quot;parallelism.Rmd&quot;     
## [22] &quot;report.R&quot;             &quot;report.Rmd&quot;           &quot;storage.Rmd&quot;         
## [25] &quot;timing.Rmd&quot;
</code></pre>

<p>Your real work is outlined in a data frame of data analysis steps called &ldquo;targets&rdquo;. The targets depend on the imports, and <code>drake</code> will figure out how they are all connected.</p>

<pre><code class="r">my_plan
## # A tibble: 15 x 2
##    target                 command                                         
##    &lt;chr&gt;                  &lt;chr&gt;                                           
##  1 &quot;&quot;                     &quot;knit(knitr_in(\&quot;report.Rmd\&quot;), file_out(\&quot;repo~
##  2 small                  simulate(48)                                    
##  3 large                  simulate(64)                                    
##  4 regression1_small      reg1(small)                                     
##  5 regression1_large      reg1(large)                                     
##  6 regression2_small      reg2(small)                                     
##  7 regression2_large      reg2(large)                                     
##  8 summ_regression1_small suppressWarnings(summary(regression1_small$resi~
##  9 summ_regression1_large suppressWarnings(summary(regression1_large$resi~
## 10 summ_regression2_small suppressWarnings(summary(regression2_small$resi~
## 11 summ_regression2_large suppressWarnings(summary(regression2_large$resi~
## 12 coef_regression1_small suppressWarnings(summary(regression1_small))$co~
## 13 coef_regression1_large suppressWarnings(summary(regression1_large))$co~
## 14 coef_regression2_small suppressWarnings(summary(regression2_small))$co~
## 15 coef_regression2_large suppressWarnings(summary(regression2_large))$co~
</code></pre>

<p>Wildcard templating generates these data frames at scale.</p>

<pre><code class="r">library(magrittr)
dataset_plan &lt;- drake_plan(
  small = simulate(5),
  large = simulate(50)
)
dataset_plan
## # A tibble: 2 x 2
##   target command     
##   &lt;chr&gt;  &lt;chr&gt;       
## 1 small  simulate(5) 
## 2 large  simulate(50)

analysis_methods &lt;- drake_plan(
  regression = regNUMBER(dataset__) # nolint
) %&gt;%
  evaluate_plan(wildcard = &quot;NUMBER&quot;, values = 1:2)
analysis_methods
## # A tibble: 2 x 2
##   target       command        
##   &lt;chr&gt;        &lt;chr&gt;          
## 1 regression_1 reg1(dataset__)
## 2 regression_2 reg2(dataset__)

analysis_plan &lt;- plan_analyses(
  plan = analysis_methods,
  datasets = dataset_plan
)
analysis_plan
## # A tibble: 4 x 2
##   target             command    
##   &lt;chr&gt;              &lt;chr&gt;      
## 1 regression_1_small reg1(small)
## 2 regression_1_large reg1(large)
## 3 regression_2_small reg2(small)
## 4 regression_2_large reg2(large)

whole_plan &lt;- rbind(dataset_plan, analysis_plan)
whole_plan
## # A tibble: 6 x 2
##   target             command     
##   &lt;chr&gt;              &lt;chr&gt;       
## 1 small              simulate(5) 
## 2 large              simulate(50)
## 3 regression_1_small reg1(small) 
## 4 regression_1_large reg1(large) 
## 5 regression_2_small reg2(small) 
## 6 regression_2_large reg2(large)
</code></pre>

<p>For the commands you pass in with the free-form <code>...</code> argument, <code>drake_plan()</code> uses tidy evaluation. For example, it supports quasiquotation with the <code>!!</code> argument. Use <code>tidy_evaluation = FALSE</code> or the <code>list</code> argument to suppress this behavior.</p>

<pre><code class="r">my_variable &lt;- 5

drake_plan(
  a = !!my_variable,
  b = !!my_variable + 1,
  list = c(d = &quot;!!my_variable&quot;)
)
## # A tibble: 3 x 2
##   target command      
##   &lt;chr&gt;  &lt;chr&gt;        
## 1 a      5            
## 2 b      5 + 1        
## 3 d      !!my_variable

drake_plan(
  a = !!my_variable,
  b = !!my_variable + 1,
  list = c(d = &quot;!!my_variable&quot;),
  tidy_evaluation = FALSE
)
## # A tibble: 3 x 2
##   target command            
##   &lt;chr&gt;  &lt;chr&gt;              
## 1 a      !(!my_variable)    
## 2 b      !(!my_variable + 1)
## 3 d      !!my_variable
</code></pre>

<p>For instances of <code>!!</code> that remain in the workflow plan, <code>make()</code> will run these commands in tidy fashion, evaluating the <code>!!</code> operator using the environment you provided.</p>

<p>Using static code analysis, <code>drake</code> detects the dependencies of all your targets. The result is an interactive network diagram.</p>

<pre><code class="r">vis_drake_graph(my_plan)
</code></pre>

<p><iframe
src = "https://ropensci.github.io/drake/images/outdated.html"
width = "100%" height = "600px" allowtransparency="true"
style="border: none; box-shadow: none">
</iframe></p>

<p>At this point, all your targets are out of date because the project is new.</p>

<pre><code class="r">config &lt;- drake_config(my_plan, verbose = FALSE) # Master configuration list
outdated(config)
##  [1] &quot;\&quot;report.md\&quot;&quot;          &quot;coef_regression1_large&quot;
##  [3] &quot;coef_regression1_small&quot; &quot;coef_regression2_large&quot;
##  [5] &quot;coef_regression2_small&quot; &quot;large&quot;                 
##  [7] &quot;regression1_large&quot;      &quot;regression1_small&quot;     
##  [9] &quot;regression2_large&quot;      &quot;regression2_small&quot;     
## [11] &quot;small&quot;                  &quot;summ_regression1_large&quot;
## [13] &quot;summ_regression1_small&quot; &quot;summ_regression2_large&quot;
## [15] &quot;summ_regression2_small&quot;
</code></pre>

<p>The <code>make()</code> function traverses the network and builds the targets that require updates.</p>

<pre><code class="r">make(my_plan)
## target large
## target small
## target regression1_large
## target regression1_small
## target regression2_large
## target regression2_small
## target coef_regression1_large
## target coef_regression1_small
## target coef_regression2_large
## target coef_regression2_small
## target summ_regression1_large
## target summ_regression1_small
## target summ_regression2_large
## target summ_regression2_small
## target file &quot;report.md&quot;
</code></pre>

<p>For the <code>reg2()</code> model on the small dataset, the p-value on <code>x2</code> is so small that there may be an association between weight and fuel efficiency after all.</p>

<pre><code class="r">readd(coef_regression2_small)
##              Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 27.504915 1.02496426 26.835000 9.676340e-30
## x2          -0.708536 0.08285938 -8.551066 4.617125e-11
</code></pre>

<p>The project is currently up to date, so the next <code>make()</code> does nothing.</p>

<pre><code class="r">make(my_plan)
## Unloading targets from environment:
##   coef_regression2_small
##   large
##   small
## All targets are already up to date.
</code></pre>

<p>But a nontrivial change in <code>reg2()</code> triggers updates to all the affected downstream targets.</p>

<pre><code class="r">reg2 &lt;- function(d){
  d$x3 &lt;- d$x ^ 3
  lm(y ~ x3, data = d)
}

make(my_plan)
## target regression2_large
## target regression2_small
## target coef_regression2_large
## target coef_regression2_small
## target summ_regression2_large
## target summ_regression2_small
## target file &quot;report.md&quot;
</code></pre>

<h1>Built-in example projects</h1>

<p><code>Drake</code> has <a href="https://github.com/ropensci/drake/tree/master/inst/examples">built-in example projects</a>. You can generate the code files for an example with <code>drake_example()</code>, and you can list the available examples with <code>drake_examples()</code>. For instance, <code>drake_example(&quot;gsp&quot;)</code> generates the R script and R Markdown report for the built-in econometrics data analysis project. See below for the currently supported examples.</p>

<h2>Learn how to use <code>drake</code>.</h2>

<ul>
<li><code>basic</code>: A tiny, minimal example with the <code>mtcars</code> dataset to demonstrate how to use <code>drake</code>. Use <code>load_basic_example()</code> to set up the project in your workspace. The <a href="https://github.com/ropensci/drake/blob/master/vignettes/example-basic.Rmd">basic example vignette</a> is a parallel walkthrough of the same example.</li>
<li><code>gsp</code>: A more concrete, practical example using real econometrics data. It explores the relationships between gross state product and other quantities, and it shows off <code>drake</code>&#39;s ability to generate lots of reproducibly-tracked tasks with ease.</li>
<li><code>packages</code>: A concrete, practical example using data on R package downloads. It demonstrates how <code>drake</code> can refresh a project based on new incoming data without restarting everything from scratch.</li>
</ul>

<h2>High-performance computing</h2>

<ul>
<li><code>Docker-psock</code>: demonstrates how to deploy targets to a <a href="https://www.docker.com/what-container">Docker container</a> using a specialized PSOCK cluster.</li>
<li><code>Makefile-cluster</code>: uses <a href="https://www.gnu.org/software/make/">Makefiles</a> to deploy targets to a generic cluster (configurable).</li>
<li><code>sge</code>: uses <code>&quot;future_lapply&quot;</code> parallelism to deploy targets to a <a href="https://supcom.hgc.jp/english/utili_info/manual/uge.html">Sun/Univa Grid Engine</a> cluster. Other clusters are similar. See the <a href="https://github.com/mllg/batchtools/tree/master/inst/templates">batchtools/inst/templates</a> and <a href="https://github.com/HenrikBengtsson/future.batchtools/tree/master/inst/templates">future.batchtools/inst/templates</a> for more example <code>*.tmpl</code> template files.</li>
<li><code>slurm</code>: similar to <code>sge</code>, but for <a href="https://slurm.schedmd.com">SLURM</a>.</li>
<li><code>torque</code>: similar to <code>sge</code>, but for <a href="http://www.adaptivecomputing.com/products/open-source/torque/">TORQUE</a>.</li>
</ul>

<p>Regarding the high-performance computing examples, there is no one-size-fits-all <code>*.tmpl</code> configuration file for any job scheduler, so we cannot guarantee that the above examples will work for you out of the box. To learn how to configure the files to suit your needs, you should make sure you understand how to use your job scheduler and <a href="https://github.com/mllg/batchtools">batchtools</a>.</p>

</body>

</html>
